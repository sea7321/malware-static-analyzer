import logging
import sys

import functions

logger = logging.getLogger(__name__)


def get_file_properties(filename):
    file_creation_date = functions.get_file_creation_date(filename)
    file_modification_date = functions.get_file_modification_date(filename)
    file_size = functions.get_file_size(filename)
    mime_type = functions.get_mime_type(filename)


def get_file_data(filename):
    ip_addresses = functions.get_ip_addresses(filename)
    urls = functions.get_urls(filename)
    emails = functions.get_emails(filename)


def check_suspicious_activity(filename):
    api_calls = functions.get_api_calls(filename)
    dll_functions = functions.get_dll_functions(filename)


def check_anti_virtual(filename):
    packed = functions.is_packed(filename)
    anti_debug_functions = functions.get_anti_debug_functions(filename)


def main():
    # parse command line arguments
    filename = sys.argv[0]

    # gather important file properties
    get_file_properties(filename)

    # gather file usage properties
    get_file_data(filename)

    # check for suspicious activity
    check_suspicious_activity(filename)

    # check for anti-virtualization features
    check_anti_virtual(filename)


if __name__ == "__main__":
    main()
